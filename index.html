<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WhatsApp Group Simulator - Join / Subscription</title>
<style>
  :root{--green:#075e54;--light:#e5ddd5;}
  body{font-family: "Helvetica Neue", Arial, sans-serif; margin:0; background:var(--light); color:#222;}
  header{background:var(--green); color:#fff; padding:12px 16px; display:flex; justify-content:space-between; align-items:center;}
  header h1{font-size:18px; margin:0;}
  header .controls button{margin-left:8px; padding:8px 10px; border-radius:6px; border:none; cursor:pointer;}
  header .controls button.join{background:#25D366; color:#fff;}
  header .controls button.admin{background:#128C7E; color:#fff;}

  #container{display:flex; gap:16px; padding:16px; box-sizing:border-box;}
  #left{flex:1; min-width:320px;}
  #chat-box{height:70vh; background:#fff; border-radius:8px; padding:14px; overflow:auto; box-shadow:0 2px 6px rgba(0,0,0,0.08);}
  .message{margin-bottom:12px; padding:10px 12px; border-radius:10px; max-width:78%;}
  .member{background:#f1f0f0; align-self:flex-start;}
  .you{background:#dcf8c6; align-self:flex-end; margin-left:auto;}
  #right{width:320px; min-width:240px;}
  .panel{background:#fff; padding:12px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.06); margin-bottom:12px;}

  form input, form select, form button{width:100%; box-sizing:border-box; padding:10px; margin-top:8px; border-radius:6px; border:1px solid #ddd;}
  .small{font-size:13px; color:#555;}
  .requests-list{max-height:200px; overflow:auto; margin-top:8px;}
  .req-item{padding:8px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; gap:8px;}
  .req-item button{padding:6px 8px; border-radius:6px; border:none; cursor:pointer;}
  .approve{background:#25D366; color:#fff;}
  .reject{background:#ff5252; color:#fff;}
  .badge{background:#128C7E; color:#fff; padding:4px 8px; border-radius:12px; font-size:12px;}

  /* modal */
  .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(0,0,0,0.5);}
  .modal.show{display:flex;}
  .modal .card{width:90%; max-width:480px; background:#fff; padding:16px; border-radius:8px;}
  .toprow{display:flex; justify-content:space-between; align-items:center; gap:8px;}
  .hint{font-size:13px; color:#666; margin-top:6px;}

  footer{padding:12px; text-align:center; font-size:13px; color:#444;}
  .small-note{font-size:13px;color:#666;margin-top:8px;}
</style>
</head>
<body>

<header>
  <h1>Sumanta Chatterjee - Banking Doubt Group Simulator</h1>
  <div class="controls">
    <button class="join" id="openJoin">Join Group</button>
    <button class="admin" id="openAdmin">Admin Login</button>
  </div>
</header>

<div id="container">
  <div id="left">
    <div id="chat-box" role="log" aria-live="polite"></div>
  </div>

  <div id="right">
    <div class="panel">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="font-weight:700;">Active Members</div>
          <div class="small" id="memberCount">0 members</div>
        </div>
        <div><span class="badge" id="statusBadge">Demo</span></div>
      </div>
      <div class="small-note">এই সাইডবারে তুমি রিকোয়েস্ট, প্ল্যান এবং অ্যাডমিন অপশন দেখতে পারবে।</div>
    </div>

    <div class="panel">
      <div style="font-weight:700;">Settings</div>
      <div class="small" style="margin-top:8px;">Message Speed (ms)</div>
      <input type="number" id="speedInput" value="4000" />
      <div class="small" style="margin-top:8px;">Show only approved members' messages?</div>
      <select id="approvedOnly">
        <option value="yes">Yes</option>
        <option value="no">No</option>
      </select>
      <div style="margin-top:10px;"><button id="applySettings" style="background:#128C7E;color:#fff;border:none;padding:8px;width:100%;border-radius:6px;cursor:pointer;">Apply</button></div>
    </div>

    <div class="panel">
      <div style="font-weight:700;">Quick Controls</div>
      <button id="sendNow" style="margin-top:8px;background:#25D366;color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;">Send One Random Message Now</button>
      <button id="clearChat" style="margin-top:8px;background:#ff5252;color:#fff;border:none;padding:8px;border-radius:6px;cursor:pointer;">Clear Chat</button>
    </div>
  </div>
</div>

<!-- Join Modal -->
<div class="modal" id="joinModal" aria-hidden="true">
  <div class="card">
    <div class="toprow">
      <h3 style="margin:0;">Join Group - সাবস্ক্রিপশন</h3>
      <button id="closeJoin" style="background:#eee;border:none;padding:6px;border-radius:6px;cursor:pointer;">Close</button>
    </div>

    <form id="joinForm">
      <label class="small">পুরা নাম</label>
      <input type="text" id="joinName" placeholder="আপনার নাম" required />

      <label class="small">WhatsApp নম্বর (ইন্ডিয়ার নম্বর – উদাহরণ: 919876543210)</label>
      <input type="text" id="joinWhats" placeholder="e.g. 919876543210" required />

      <label class="small">সাবস্ক্রিপশন প্ল্যান</label>
      <select id="planSelect">
        <option value="monthly">Monthly - ₹100 (placeholder)</option>
        <option value="quarter">Quarterly - ₹250 (placeholder)</option>
        <option value="year">Yearly - ₹900 (placeholder)</option>
      </select>

      <div class="hint">পেমেন্টের জন্য কোনো পেমেন্ট গেটওয়ে যুক্ত করা নেই — পেমেন্ট এড-হক/ম্যানুয়াল।</div>

      <button type="submit" style="background:#128C7E;color:#fff;margin-top:12px;">Join & Send Request</button>
    </form>

    <div class="small hint" id="afterJoin" style="display:none;margin-top:10px;">
      ধন্যবাদ! তোমার রিকোয়েস্ট জমা হয়েছে। অনুমোদনের জন্য নিচের বাটনে ক্লিক করে Sumanta-কে WhatsApp মেসেজ পাঠাও — অথবা নিজের WhatsApp-এ গিয়ে মেসেজ করে অনুমোদন চাও।
      <div style="margin-top:8px;">
        <a id="waLink" href="#" target="_blank" style="background:#25D366;color:#fff;padding:8px 10px;border-radius:6px;text-decoration:none;display:inline-block;">Message Sumanta on WhatsApp</a>
      </div>
    </div>
  </div>
</div>

<!-- Admin Modal -->
<div class="modal" id="adminModal" aria-hidden="true">
  <div class="card">
    <div class="toprow">
      <h3 style="margin:0;">Admin Panel</h3>
      <button id="closeAdmin" style="background:#eee;border:none;padding:6px;border-radius:6px;cursor:pointer;">Close</button>
    </div>

    <div id="adminLoginArea" style="margin-top:12px;">
      <label class="small">Admin Password</label>
      <input type="password" id="adminPass" placeholder="Password" />
      <button id="adminLoginBtn" style="background:#128C7E;color:#fff;margin-top:8px;">Login</button>
      <div class="small hint" style="margin-top:8px;">(লোকালি কাজ করে - পাসওয়ার্ড: <strong>sumanta123</strong>)</div>
    </div>

    <div id="adminPanelArea" style="display:none;margin-top:12px;">
      <div style="font-weight:700;">Pending Requests</div>
      <div class="requests-list" id="requestsList"></div>

      <div style="margin-top:12px;font-weight:700;">Manually Add Member</div>
      <input id="manualName" placeholder="Name" />
      <input id="manualWhats" placeholder="Whats (919...)" style="margin-top:8px;" />
      <button id="manualAdd" style="background:#25D366;color:#fff;margin-top:8px;">Add Member</button>

      <div style="margin-top:12px;"><button id="logoutAdmin" style="background:#ff5252;color:#fff;padding:8px;border-radius:6px;border:none;cursor:pointer;">Logout</button></div>
    </div>
  </div>
</div>

<footer>
  <div>Developed for Sumanta Chatterjee — Demo simulator (client-side)</div>
  <div class="small">আপনি চাইলে আমি এই ফাইলটিকে আরো শক্তিশালী করে দেব (পেমেন্ট, ব্যাকএন্ড, নিরাপদ অ্যাডমিন ইত্যাদি)।</div>
</footer>

<script>
/* --------- Configuration --------- */
const SUMANTA_WHATSAPP = "917866070549"; // তোমার দেয়া নম্বর — wa.me expects country code without '+'
const ADMIN_PASSWORD = "sumanta123"; // লোকালি ক্লায়েন্ট-সাইড পাসওয়ার্ড (ডেমো)

/* --------- Starter data --------- */
let members = [
  "Riya Sharma","Akash Verma","Suman Roy","Puja Singh","Ankit Kumar","Rahul Das","Banking Quiz Bot"
];

let approvedMembers = new Set(members); // শুরুতে ডিফল্ট সদস্যরা অনুমোদিত
let pendingRequests = JSON.parse(localStorage.getItem("pendingRequests")||"[]");

/* Example question banks */
const englishQuestions = [
  "What is the synonym of 'Surge'?",
  "Choose the correct article: ___ honest man.",
  "Error Spotting: 'Neither of the students are present.'"
];
const quantQuestions = [
  "If SP = 840 and CP = 750, find profit %.",
  "Find next number: 17, 34, 68, 136, ?",
  "Simplify: (45 ÷ 5) × (12 ÷ 3)."
];
const reasoningQuestions = [
  "Find the odd one out: Lemon, Orange, Apple, Carrot.",
  "Para-Jumble: Arrange the sentence blocks logically.",
  "Which number replaces ?: 2, 6, 12, 20, ?"
];

const chatBox = document.getElementById("chat-box");
const memberCountEl = document.getElementById("memberCount");
const statusBadge = document.getElementById("statusBadge");

/* --------- UI Helpers --------- */
function renderMembersCount(){
  memberCountEl.textContent = `${approvedMembers.size} approved members`;
}
function appendMessage(name, text, isYou=false){
  const div = document.createElement("div");
  div.className = "message " + (isYou ? "you" : "member");
  div.innerHTML = `<strong>${name}:</strong> ${text}`;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

/* initial messages */
appendMessage("System", "Welcome to the Banking Doubt Group Simulator. Join via Join button to request access.", false);
renderMembersCount();

/* --------- Message sending logic --------- */
let speed = parseInt(document.getElementById("speedInput").value,10) || 4000;
let approvedOnly = document.getElementById("approvedOnly").value === "yes";
let autoTimer = null;

function pickRandomQuestion(){
  const bank = [englishQuestions, quantQuestions, reasoningQuestions][Math.floor(Math.random()*3)];
  return bank[Math.floor(Math.random()*bank.length)];
}

function sendRandomMessage(){
  // choose a member - only approved ones if setting on
  const pool = Array.from(approvedMembers);
  if(pool.length === 0) return;
  const sender = pool[Math.floor(Math.random()*pool.length)];
  const q = pickRandomQuestion();
  appendMessage(sender, q, false);
}

function startAutoMessages(){
  stopAutoMessages();
  autoTimer = setInterval(sendRandomMessage, speed);
}

function stopAutoMessages(){
  if(autoTimer) clearInterval(autoTimer);
}

startAutoMessages();

/* Controls */
document.getElementById("applySettings").addEventListener("click", ()=>{
  speed = parseInt(document.getElementById("speedInput").value,10) || 4000;
  approvedOnly = document.getElementById("approvedOnly").value === "yes";
  if(approvedOnly){
    // show only approved messages by clearing and re-adding a note
    chatBox.innerHTML = "";
    appendMessage("System","Now showing messages only from approved members.","false");
  }
  startAutoMessages();
});

document.getElementById("sendNow").addEventListener("click", sendRandomMessage);
document.getElementById("clearChat").addEventListener("click", ()=>{ chatBox.innerHTML=""; appendMessage("System","Chat cleared.","false"); });

/* --------- Join modal logic --------- */
const joinModal = document.getElementById("joinModal");
document.getElementById("openJoin").addEventListener("click", ()=>{ joinModal.classList.add("show"); });
document.getElementById("closeJoin").addEventListener("click", ()=>{ joinModal.classList.remove("show"); });

const joinForm = document.getElementById("joinForm");
const afterJoin = document.getElementById("afterJoin");
const waLink = document.getElementById("waLink");

joinForm.addEventListener("submit", (e)=>{
  e.preventDefault();
  const name = document.getElementById("joinName").value.trim();
  const whats = document.getElementById("joinWhats").value.trim();
  const plan = document.getElementById("planSelect").value;
  if(!name || !whats){ alert("সব ফিল্ড পূরণ করুন।"); return; }

  // store pending request locally
  pendingRequests.push({name, whats, plan, ts: Date.now()});
  localStorage.setItem("pendingRequests", JSON.stringify(pendingRequests));

  // prepare WhatsApp link - prefilled message to Sumanta
  const msg = encodeURIComponent(`Hello Sumanta, I want to join your group.\nName: ${name}\nWhatsApp: ${whats}\nPlan: ${plan}\nPlease approve.`);
  waLink.href = `https://wa.me/${SUMANTA_WHATSAPP}?text=${msg}`;
  waLink.target = "_blank";

  // show after-join message
  afterJoin.style.display = "block";
  joinForm.style.display = "none";
});

/* --------- Admin modal logic --------- */
const adminModal = document.getElementById("adminModal");
document.getElementById("openAdmin").addEventListener("click", ()=>{ adminModal.classList.add("show"); });
document.getElementById("closeAdmin").addEventListener("click", ()=>{ adminModal.classList.remove("show"); });

const adminLoginBtn = document.getElementById("adminLoginBtn");
adminLoginBtn.addEventListener("click", ()=>{
  const pass = document.getElementById("adminPass").value;
  if(pass === ADMIN_PASSWORD){
    document.getElementById("adminLoginArea").style.display = "none";
    document.getElementById("adminPanelArea").style.display = "block";
    renderRequests();
  } else {
    alert("পাসওয়ার্ড ভুল।");
  }
});

document.getElementById("logoutAdmin").addEventListener("click", ()=>{
  document.getElementById("adminPass").value = "";
  document.getElementById("adminLoginArea").style.display = "block";
  document.getElementById("adminPanelArea").style.display = "none";
});

/* render pending requests */
function renderRequests(){
  const el = document.getElementById("requestsList");
  el.innerHTML = "";
  if(pendingRequests.length === 0){
    el.innerHTML = "<div class='small' style='padding:8px;'>No pending requests.</div>";
    return;
  }
  pendingRequests.forEach((r, idx)=>{
    const div = document.createElement("div");
    div.className = "req-item";
    div.innerHTML = `<div><strong>${r.name}</strong><div class="small">${r.whats} · ${r.plan}</div></div>`;
    const actions = document.createElement("div");
    const approveBtn = document.createElement("button");
    approveBtn.className = "approve";
    approveBtn.textContent = "Approve";
    approveBtn.addEventListener("click", ()=>{ approveRequest(idx); });
    const rejectBtn = document.createElement("button");
    rejectBtn.className = "reject";
    rejectBtn.textContent = "Reject";
    rejectBtn.style.marginLeft = "6px";
    rejectBtn.addEventListener("click", ()=>{ rejectRequest(idx); });
    actions.appendChild(approveBtn);
    actions.appendChild(rejectBtn);
    div.appendChild(actions);
    el.appendChild(div);
  });
}

/* approve/reject */
function approveRequest(index){
  const req = pendingRequests[index];
  if(!req) return;
  approvedMembers.add(req.name);
  // Optionally store member details (we just store name for demo)
  pendingRequests.splice(index,1);
  localStorage.setItem("pendingRequests", JSON.stringify(pendingRequests));
  renderRequests();
  renderMembersCount();
  appendMessage("System", `${req.name} has been APPROVED by admin.`, false);
}

function rejectRequest(index){
  const req = pendingRequests[index];
  if(!req) return;
  pendingRequests.splice(index,1);
  localStorage.setItem("pendingRequests", JSON.stringify(pendingRequests));
  renderRequests();
  appendMessage("System", `${req.name} has been REJECTED by admin.`, false);
}

/* manual add */
document.getElementById("manualAdd").addEventListener("click", ()=>{
  const name = document.getElementById("manualName").value.trim();
  const whats = document.getElementById("manualWhats").value.trim();
  if(!name){ alert("নাম লিখুন"); return; }
  approvedMembers.add(name);
  renderMembersCount();
  appendMessage("System", `${name} manually added by admin.`, false);
  document.getElementById("manualName").value = "";
  document.getElementById("manualWhats").value = "";
});

/* show pending count in header badge */
function updateStatusBadge(){
  statusBadge.textContent = pendingRequests.length ? `${pendingRequests.length} pending` : "Live";
}
setInterval(updateStatusBadge,1000);

/* load any saved pending into UI */
renderMembersCount();
updateStatusBadge();

/* allow manual hide join reset when modal closed */
joinModal.addEventListener("click", (e)=>{
  if(e.target === joinModal){
    joinModal.classList.remove("show");
    // reset form
    joinForm.style.display = "block";
    afterJoin.style.display = "none";
    joinForm.reset();
  }
});
adminModal.addEventListener("click", (e)=>{
  if(e.target === adminModal) adminModal.classList.remove("show");
});

/* End of script */
</script>

</body>
</html>
